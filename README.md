# Captain CMD Tools

## ç®€ä»‹

Captain CMD Tools æ˜¯ä¸€ä¸ªåŸºäº LangChain å’Œ LangGraph çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºä¸ LLM è¿›è¡Œäº¤äº’ã€‚æ”¯æŒé•¿ä¸Šä¸‹æ–‡å­˜å‚¨ï¼Œä¿å­˜ç”¨æˆ·å¯¹è¯å†å²ã€‚æŒ‰é‡è°ƒç”¨LLMï¼Œæ”¯æŒè‡ªå®šä¹‰æ¨¡å‹ï¼Œæ— è°ƒç”¨é™åˆ¶ã€‚

## ä½¿ç”¨æ–¹æ³•

### 1. config.toml é…ç½®æ–‡ä»¶

```toml
[mcp_servers]
content = '''
{
    "mcpServers": {
        "example-stdio-mcp-name": {
            "transport": "stdio", 
            "command": "python.exe", 
            "args": ["path/to/example_mcp.py"]
        },
        "example-tcp-mcp-name": {
            "transport": "streamable_http",
            "url": "http://mcp-server:port/mcp"
        }
     }
}
'''

[model_config]
model_name = ""
api_key = ""
base_url = ""
system_prompt = ""

# SubAgent model
sub_agent = ["sub_agent_1", "sub_agent_2"]

sub_agent_model_config = '''
{
    "sub_agent_1": {
        "model_name": "",
        "api_key": "",
        "base_url": "",
        "system_prompt": "",
        "tool_names": ["example-stdio-mcp-name", "..."]
    },
    "sub_agent_2": {
        "model_name": "",
        "api_key": "",
        "base_url": "",
        "system_prompt": "",
        "tool_names": ["example-tcp-mcp-name", "..."]
    }
}
'''

tavily_api_key = ""
```

### 2. è¿è¡Œå‘½ä»¤

* --config æ˜¯é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤æ˜¯ config.tomlã€‚
* --workspace æ˜¯å·¥ä½œç©ºé—´è·¯å¾„ã€‚
* --output æ˜¯è¾“å‡ºæ–‡ä»¶è·¯å¾„ã€‚

```bash
python main.py --config config.toml --workspace workspace --output output.md
```

```text
(.venv) PS E:\DM\captain_cmd> python .\main.py --config .\config.toml --workspace . --output ./out.md

ğŸš€ Welcome to Captain Cmd Tools

  Model          claude-haiku-4-5-20251001-thinking
  Workspace      .
  CheckpointDB   .\.captain\checkpoint.db
  StoreDB        .\.captain\store.db


Type 'exit' or 'quit' to exit


> ä½ ç°åœ¨èƒ½è°ƒç”¨å“ªäº›å·¥å…·ï¼Ÿ

[init_resources] Database resources initialized
[build_sub_agent] Loaded 40 tools for 'ida-mcp-proxy'
[build_agent] Sub agent 'ida_agent' built successfully
[build_agent] Initialized major model 'claude-haiku-4-5-20251001-thinking'
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ¤” Model Thinking â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ç”¨æˆ·ç”¨ä¸­æ–‡é—®æˆ‘ç°åœ¨èƒ½è°ƒç”¨å“ªäº›å·¥å…·ã€‚æˆ‘åº”è¯¥ç”¨ä¸­æ–‡å›ç­”ï¼Œåˆ—å‡ºæˆ‘å¯ä»¥ä½¿ç”¨çš„æ‰€æœ‰å·¥å…·ã€‚                                           â”‚
â”‚                                                                                                                          â”‚
â”‚ è®©æˆ‘åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„å·¥å…·ï¼š                                                                                                 â”‚
â”‚                                                                                                                          â”‚
â”‚ 1. write_todos - åˆ›å»ºå’Œç®¡ç†ä»»åŠ¡åˆ—è¡¨                                                                                      â”‚
â”‚ 2. ls - åˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶                                                                                             â”‚
â”‚ 3. read_file - è¯»å–æ–‡ä»¶                                                                                                  â”‚
â”‚ 4. write_file - å†™å…¥æ–°æ–‡ä»¶                                                                                               â”‚
â”‚ 5. edit_file - ç¼–è¾‘æ–‡ä»¶                                                                                                  â”‚
â”‚ 6. glob - é€šè¿‡æ¨¡å¼åŒ¹é…æŸ¥æ‰¾æ–‡ä»¶                                                                                           â”‚
â”‚ 7. grep - æœç´¢æ–‡ä»¶ä¸­çš„æ–‡æœ¬                                                                                               â”‚
â”‚ 8. task - å¯åŠ¨å­ä»£ç†å¤„ç†ç‹¬ç«‹ä»»åŠ¡                                                                                         â”‚
â”‚ 9. shell_exec - æ‰§è¡Œshellå‘½ä»¤                                                                                            â”‚
â”‚ 10. internet_search - ç½‘ç»œæœç´¢                                                                                           â”‚
â”‚                                                                                                                          â”‚
â”‚ æˆ‘åº”è¯¥ç”¨ä¸­æ–‡æä¾›æ¸…æ™°çš„è¯´æ˜ã€‚                                                                                             â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ’¬ Model Answer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ æˆ‘ç°åœ¨å¯ä»¥è°ƒç”¨ä»¥ä¸‹å·¥å…·ï¼š                                                                                                 â”‚
â”‚                                                                                                                          â”‚
â”‚                                                                                                                          â”‚
â”‚                                                       ğŸ“‹ ä»»åŠ¡ç®¡ç†                                                        â”‚
â”‚                                                                                                                          â”‚
â”‚  â€¢ write_todos - åˆ›å»ºå’Œç®¡ç†ä»»åŠ¡åˆ—è¡¨ï¼Œè¿½è¸ªè¿›åº¦                                                                            â”‚
â”‚                                                                                                                          â”‚
â”‚                                                                                                                          â”‚
â”‚                                                     ğŸ“ æ–‡ä»¶ç³»ç»Ÿæ“ä½œ                                                      â”‚
â”‚                                                                                                                          â”‚
â”‚  â€¢ ls - åˆ—å‡ºæŒ‡å®šç›®å½•çš„æ–‡ä»¶                                                                                               â”‚
â”‚  â€¢ read_file - è¯»å–æ–‡ä»¶å†…å®¹                                                                                              â”‚
â”‚  â€¢ write_file - åˆ›å»ºæ–°æ–‡ä»¶                                                                                               â”‚
â”‚  â€¢ edit_file - ç¼–è¾‘å·²æœ‰æ–‡ä»¶                                                                                              â”‚
â”‚  â€¢ glob - é€šè¿‡æ¨¡å¼åŒ¹é…æŸ¥æ‰¾æ–‡ä»¶ï¼ˆå¦‚ **/*.pyï¼‰                                                                             â”‚
â”‚  â€¢ grep - åœ¨æ–‡ä»¶ä¸­æœç´¢ç‰¹å®šæ–‡æœ¬                                                                                           â”‚
â”‚                                                                                                                          â”‚
â”‚                                                                                                                          â”‚
â”‚                                                       ğŸ’» å‘½ä»¤æ‰§è¡Œ                                                        â”‚
â”‚                                                                                                                          â”‚
â”‚  â€¢ shell_exec - æ‰§è¡Œshellå‘½ä»¤å¹¶è¿”å›è¾“å‡º                                                                                  â”‚
â”‚                                                                                                                          â”‚
â”‚                                                                                                                          â”‚
â”‚                                                       ğŸŒ ç½‘ç»œæœç´¢                                                        â”‚
â”‚                                                                                                                          â”‚
â”‚  â€¢ internet_search - è¿›è¡Œç½‘ç»œæœç´¢ï¼ˆæ”¯æŒé€šç”¨ã€æ–°é—»ã€é‡‘èä¸»é¢˜ï¼‰                                                            â”‚
â”‚                                                                                                                          â”‚
â”‚                                                                                                                          â”‚
â”‚                                                        ğŸ¤– å­ä»£ç†                                                         â”‚
â”‚                                                                                                                          â”‚
â”‚  â€¢ task - å¯åŠ¨ç‹¬ç«‹çš„å­ä»£ç†å¤„ç†å¤æ‚çš„å¤šæ­¥ä»»åŠ¡                                                                             â”‚
â”‚     â€¢ æ”¯æŒ general-purpose ç±»å‹ï¼ˆé€šç”¨ä»»åŠ¡ï¼‰                                                                              â”‚
â”‚     â€¢ æ”¯æŒ ida_agent ç±»å‹ï¼ˆIDA ProäºŒè¿›åˆ¶åˆ†æï¼‰                                                                           â”‚
â”‚                                                                                                                          â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ çš„å—ï¼Ÿ æ¯”å¦‚æŸ¥æ‰¾æ–‡ä»¶ã€æœç´¢ä¿¡æ¯ã€æ‰§è¡Œå‘½ä»¤ç­‰ï¼Œæˆ–è€…å¤„ç†CTFç›¸å…³çš„ä»»åŠ¡ï¼Ÿ                                       â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

> IDA ä¸­æ‰“å¼€çš„ç¨‹åºä¸»è¦æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ¤” Model Thinking â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ç”¨æˆ·é—®çš„æ˜¯"IDAä¸­æ‰“å¼€çš„ç¨‹åºä¸»è¦æ˜¯åšä»€ä¹ˆçš„"ï¼Œä½†æˆ‘æ²¡æœ‰ä»»ä½•å…³äºIDAå½“å‰æ‰“å¼€äº†ä»€ä¹ˆç¨‹åºçš„ä¿¡æ¯ã€‚                                 â”‚
â”‚                                                                                                                          â”‚
â”‚ IDA (Interactive DisAssembler) æ˜¯ä¸€ä¸ªåæ±‡ç¼–å’Œè°ƒè¯•å·¥å…·ã€‚ç”¨æˆ·å¯èƒ½æ˜¯ï¼š                                                      â”‚
â”‚ 1. åœ¨ä»–ä»¬çš„æœ¬åœ°ç¯å¢ƒä¸­æœ‰IDAæ‰“å¼€                                                                                           â”‚
â”‚ 2. é—®æˆ‘æ˜¯å¦èƒ½çœ‹åˆ°ä»–ä»¬IDAä¸­çš„å†…å®¹                                                                                         â”‚
â”‚ 3. è¿™æ˜¯ä¸€ä¸ªCTFç›¸å…³çš„é—®é¢˜                                                                                                 â”‚
â”‚                                                                                                                          â”‚
â”‚ ç”±äºæˆ‘æ²¡æœ‰ç›´æ¥è®¿é—®ç”¨æˆ·æœ¬åœ°IDAç¨‹åºçš„èƒ½åŠ›ï¼Œä½†æˆ‘ç¡®å®æœ‰`ida_agent`è¿™ä¸ªå­ä»£ç†å¯ç”¨ã€‚è¿™ä¸ªå­ä»£ç†è¢«æè¿°ä¸º"IDA Pro Agent, use it   â”‚
â”‚ to analyze binaries that opened by IDA Pro"ã€‚                                                                            â”‚
â”‚                                                                                                                          â”‚
â”‚ è¿™è¡¨æ˜ida_agentå¯èƒ½æœ‰æŸç§æ–¹å¼è¿æ¥åˆ°æ‰“å¼€çš„IDAå®ä¾‹ã€‚æˆ‘åº”è¯¥å°è¯•ä½¿ç”¨ida_agentæ¥æ£€æŸ¥IDAä¸­å½“å‰æ‰“å¼€çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚               â”‚
â”‚                                                                                                                          â”‚
â”‚ è®©æˆ‘ç”¨taskå·¥å…·å¯åŠ¨ida_agentæ¥æŸ¥è¯¢IDAä¸­æ‰“å¼€çš„ç¨‹åºä¿¡æ¯ã€‚                                                                   â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ’¬ Model Answer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ æˆ‘æ¥å¸®ä½ æŸ¥è¯¢IDAä¸­å½“å‰æ‰“å¼€çš„ç¨‹åºã€‚è®©æˆ‘ä½¿ç”¨IDA Proä»£ç†æ¥åˆ†æï¼š                                                             â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ âœ… task - Complete â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ğŸ”§ task                                                                                                                  â”‚
â”‚ Args: {                                                                                                                  â”‚
â”‚   "subagent_type": "ida_agent",                                                                                          â”‚
â”‚   "description": "è¯·æ£€æŸ¥IDA Proä¸­å½“å‰æ‰“å¼€çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶åˆ†æå®ƒä¸»è¦åšä»€ä¹ˆã€‚åŒ…æ‹¬ï¼š\n1. ç¨‹åºçš„æ–‡ä»¶åå’Œç±»å‹\n2.             â”‚
â”‚ ç¨‹åºçš„ä¸»è¦åŠŸèƒ½å’Œç”¨é€”\n3. ä¸»å…¥å£ç‚¹(main)é™„è¿‘çš„ä»£ç é€»è¾‘\n4. ç¨‹åºä½¿ç”¨çš„å…³é”®å‡½æ•°æˆ–åº“\n5.                                     â”‚
â”‚ ç®€è¦æ€»ç»“ç¨‹åºçš„ç›®çš„\n\nè¯·æä¾›è¯¦ç»†çš„åˆ†ææŠ¥å‘Šã€‚"                                                                            â”‚
â”‚ }                                                                                                                        â”‚
â”‚                                                                                                                          â”‚
â”‚ Result:                                                                                                                  â”‚
â”‚ å®Œç¾ï¼ç°åœ¨æˆ‘æœ‰äº†è¶³å¤Ÿçš„ä¿¡æ¯ã€‚è®©æˆ‘ä¸ºæ‚¨ç”Ÿæˆè¯¦ç»†çš„åˆ†ææŠ¥å‘Šï¼š                                                                 â”‚
â”‚                                                                                                                          â”‚
â”‚ ---                                                                                                                      â”‚
â”‚                                                                                                                          â”‚
â”‚ # **IDA Pro äºŒè¿›åˆ¶æ–‡ä»¶åˆ†ææŠ¥å‘Š**                                                                                         â”‚
â”‚                                                                                                                          â”‚
â”‚ ## ğŸ“‹ **1. ç¨‹åºåŸºæœ¬ä¿¡æ¯**                                                                                                â”‚
â”‚                                                                                                                          â”‚
â”‚ | é¡¹ç›® | è¯¦æƒ… |                                                                                                          â”‚
â”‚ |------|------|                                                                                                          â”‚
â”‚ | **æ–‡ä»¶å** | `cstecgi.cgi` |                                                                                           â”‚
â”‚ | **æ–‡ä»¶ç±»å‹** | CGI å¯æ‰§è¡Œç¨‹åºï¼ˆ32ä½ MIPS æ¶æ„ï¼‰ |                                                                      â”‚
â”‚ | **æ¶æ„** | MIPS (32-bit) |                                                                                             â”‚
â”‚ | **æ–‡ä»¶å“ˆå¸Œ** | `27e0130c150897cc2faeff67fff392e44e1551973a0c4c5e36ddb4bc8c8b4dcc` |                                    â”‚
â”‚ | **ä¸»å…¥å£ç‚¹** | `main @ 0x424678 (4347640)` |                                                                           â”‚
â”‚ | **æ€»å‡½æ•°æ•°** | 464ä¸ª |                                                                                                 â”‚
â”‚                                                                                                                          â”‚
â”‚ ---                                                                                                                      â”‚
â”‚                                                                                                                          â”‚
â”‚ ## ğŸ¯ **2. ç¨‹åºä¸»è¦åŠŸèƒ½å’Œç”¨é€”**                                                                                          â”‚
â”‚                                                                                                                          â”‚
â”‚ è¿™æ˜¯ä¸€ä¸ª**TOTOLINKè·¯ç”±å™¨ç®¡ç†ç•Œé¢çš„CGIå¤„ç†ç¨‹åº**ï¼Œä¸»è¦ç”¨äºå¤„ç†Webç®¡ç†åå°çš„å„ç§è¯·æ±‚ã€‚æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š                       â”‚
â”‚                                                                                                                          â”‚
â”‚ ### **ä¸»è¦åŠŸèƒ½æ¨¡å—ï¼š**                                                                                                   â”‚
â”‚                                                                                                                          â”‚
â”‚ 1. **è®¤è¯ä¸å®‰å…¨ç®¡ç†**                                                                                                    â”‚
â”‚    - åŸºäºTokençš„ä¼šè¯ç®¡ç†ï¼ˆ5åˆ†é’Ÿè¶…æ—¶ï¼‰                                                                                    â”‚
â”‚    - Cookieå’Œè¿œç¨‹IPåœ°å€éªŒè¯                                                                                              â”‚
â”‚    - Telnetéšè—åé—¨åŠŸèƒ½                                                                                                  â”‚
â”‚                                                                                                                          â”‚
â”‚ 2. **å›ºä»¶ä¸é…ç½®ç®¡ç†**                                                                                                    â”‚
â”‚    - å›ºä»¶ä¸Šä¼ å’Œå‡çº§å¤„ç†                                                                                                  â”‚
â”‚    - ç³»ç»Ÿé…ç½®å¯¼å…¥/å¯¼å‡º                                                                                                   â”‚
â”‚    - OpenVPNè¯ä¹¦ç®¡ç†                                                                                                     â”‚
â”‚                                                                                                                          â”‚
â”‚ 3. **ç³»ç»Ÿé…ç½®API**                                                                                                       â”‚
â”‚    - è·å–ç³»ç»Ÿåˆå§‹åŒ–é…ç½®(`getInitCfg`)                                                                                    â”‚
â”‚    - è·å–ç™»å½•é…ç½®(`getLoginCfg`)                                                                                         â”‚
â”‚    - è·å–ç³»ç»ŸçŠ¶æ€(`getSysStatusCfg`)                                                                                     â”‚
â”‚    - è®¾ç½®WiFiã€ç½‘ç»œã€DDNSç­‰é…ç½®                                                                                          â”‚
â”‚                                                                                                                          â”‚
â”‚ 4. **ç‰¹æ®Šæ“ä½œ**                                                                                                          â”‚
â”‚    - Telnetè¿œç¨‹è®¿é—®æ§åˆ¶                                                                                                  â”‚
â”‚    - OpenVPNé…ç½®æ–‡ä»¶å¯¼å‡º                                                                                                 â”‚
â”‚                                                                                                                          â”‚
â”‚ ---                                                                                                                      â”‚
â”‚                                                                                                                          â”‚
â”‚ ## ğŸ” **3. ä¸»å…¥å£ç‚¹(main)ä»£ç é€»è¾‘åˆ†æ**                                                                                  â”‚
â”‚                                                                                                                          â”‚
â”‚ ### **ä¸»è¦æ‰§è¡Œæµç¨‹ï¼š**                                                                                                   â”‚
â”‚                                                                                                                          â”‚
â”‚ ```                                                                                                                      â”‚
â”‚ main()                                                                                                                   â”‚
â”‚   â”œâ”€ åˆå§‹åŒ–MIBç³»ç»Ÿ (apmib_init)                                                                                          â”‚
â”‚   â”œâ”€ è§£æCGIè¯·æ±‚å‚æ•°                                                                                                     â”‚
â”‚   â”‚   â”œâ”€ QUERY_STRING (URLå‚æ•°)                                                                                          â”‚
â”‚   â”‚   â””â”€ CONTENT_LENGTH (POSTæ•°æ®)                                                                                       â”‚
â”‚   â”‚                                                                                                                      â”‚
â”‚   â”œâ”€ å¤„ç†å››ç§æ ¸å¿ƒåŠ¨ä½œ:                                                                                                   â”‚
â”‚   â”‚   â”‚                                                                                                                  â”‚
â”‚   â”‚   â”œâ”€ action=telnet (éšè—åé—¨)                                                                                        â”‚
â”‚   â”‚                                                                                                                      â”‚
â”‚ ... (truncated)                                                                                                          â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ’¬ Model Answer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                                                                          â”‚
â”‚                                                           æ€»ç»“                                                           â”‚
â”‚                                                                                                                          â”‚
â”‚ IDAä¸­æ‰“å¼€çš„ç¨‹åºæ˜¯ cstecgi.cgi - ä¸€ä¸ª TOTOLINKè·¯ç”±å™¨ç®¡ç†ç³»ç»Ÿçš„CGIå¤„ç†ç¨‹åºã€‚                                               â”‚
â”‚                                                                                                                          â”‚
â”‚                                                      ğŸ¯ ä¸»è¦ç”¨é€”ï¼š                                                       â”‚
â”‚                                                                                                                          â”‚
â”‚ è¿™ä¸ªç¨‹åºæ˜¯è·¯ç”±å™¨Webç®¡ç†åå°çš„æ ¸å¿ƒå¤„ç†å¼•æ“ï¼Œä¸»è¦è´Ÿè´£ï¼š                                                                    â”‚
â”‚                                                                                                                          â”‚
â”‚  1 ç³»ç»Ÿé…ç½®ç®¡ç† - è·å–/è®¾ç½®WiFiã€WANã€LANã€DDNSç­‰é…ç½®                                                                    â”‚
â”‚  2 è®¤è¯ä¸å®‰å…¨ - åŸºäºTokençš„ä¼šè¯ç®¡ç†å’Œç™»å½•éªŒè¯                                                                            â”‚
â”‚  3 å›ºä»¶å‡çº§ - å¤„ç†å›ºä»¶æ–‡ä»¶ä¸Šä¼ å’Œæ›´æ–°                                                                                     â”‚
â”‚  4 OpenVPNç®¡ç† - ç”¨æˆ·å’ŒæœåŠ¡å™¨è¯ä¹¦çš„ç”Ÿæˆä¸ç®¡ç†                                                                            â”‚
â”‚  5 éšè—åé—¨ - åŒ…å«ä¸€ä¸ªTelnetåé—¨åŠŸèƒ½ï¼ˆå¯†ç ï¼šb6aff1969ï¼‰                                                                  â”‚
â”‚                                                                                                                          â”‚
â”‚                                                     âš ï¸ æ ¸å¿ƒå®‰å…¨é—®é¢˜ï¼š                                                     â”‚
â”‚                                                                                                                          â”‚
â”‚  â€¢ ğŸš¨ ç¡¬ç¼–ç åé—¨å¯†ç                                                                                                      â”‚
â”‚  â€¢ ğŸš¨ å¼±éªŒè¯ç æœºåˆ¶ï¼ˆMMDDYYYYæ ¼å¼ï¼‰                                                                                       â”‚
â”‚  â€¢ ğŸš¨ å‘½ä»¤æ³¨å…¥é£é™©                                                                                                       â”‚
â”‚  â€¢ âš ï¸ ä¼šè¯è¶…æ—¶è¾ƒé•¿ï¼ˆ5åˆ†é’Ÿï¼‰                                                                                               â”‚
â”‚                                                                                                                          â”‚
â”‚ è¿™çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªCTFé¶æœºæˆ–å®‰å…¨ç ”ç©¶ç›®æ ‡ï¼ŒåŒ…å«å¤šä¸ªå¯è¢«åˆ©ç”¨çš„æ¼æ´ã€‚éœ€è¦è¿›ä¸€æ­¥åˆ†æå—ï¼Ÿ                                          â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

> 


âš ï¸  Interrupted by user (Press Ctrl+C again to exit)
Do you want to exit? (y/n):

ğŸ‘‹ Goodbye!
[cleanup] Store connection closed
[cleanup] Checkpoint connection closed
```

### 3. æ”¯æŒçš„å‘½ä»¤

shell å‘½ä»¤ï¼šç”¨äºæ‰§è¡Œshellå‘½ä»¤ï¼Œä¾‹å¦‚ï¼š`shell ls` æˆ– `shell pwd`ã€‚

```bash
> shell ls

                                    ğŸ–¥ï¸  Shell: ls                                                        

  agent
  build_with_nuitka.py
  build_with_pyinstaller.py
  chat
  config.example.toml
  config.toml
  main.py
  out.md
  README.md
  requirements.txt
  test.py
  tools
  utils
```

exit å‘½ä»¤ï¼šç”¨äºé€€å‡ºç¨‹åºï¼Œä¾‹å¦‚ï¼š`exit`ã€‚

```text
> exit
ğŸ‘‹ Goodbye!
```
